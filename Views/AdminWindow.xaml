<Window x:Class="AccommodationSystem.Views.AdminWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ç®¡ç†ç”»é¢" Width="1100" Height="750"
        WindowStartupLocation="CenterOwner"
        Background="{StaticResource BackgroundBrush}">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="50"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Background="{StaticResource PrimaryBrush}">
            <TextBlock Text="âš™  ç®¡ç†ç”»é¢" Foreground="White" FontSize="16" FontWeight="Bold"
                       VerticalAlignment="Center" Margin="20,0"/>
        </Border>

        <TabControl Grid.Row="1" Margin="12" Background="Transparent" BorderThickness="0">

            <!-- â‘  å®¿æ³Šè€…ä¸€è¦§ -->
            <TabItem Header="å®¿æ³Šè€…ä¸€è¦§">
                <Grid Margin="8">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
                    <Border Grid.Row="0" Style="{StaticResource CardBorder}" Margin="0,0,0,8">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="110"/>
                                <ColumnDefinition Width="8"/>
                                <ColumnDefinition Width="130"/>
                                <ColumnDefinition Width="8"/>
                                <ColumnDefinition Width="130"/>
                                <ColumnDefinition Width="8"/>
                                <ColumnDefinition Width="90"/>
                                <ColumnDefinition Width="8"/>
                                <ColumnDefinition Width="90"/>
                            </Grid.ColumnDefinitions>
                            <TextBox x:Name="ListSearchBox" Grid.Column="0"
                                     Style="{StaticResource PlaceholderTextBox}" Tag="æ°åæ¤œç´¢..."
                                     Margin="0,0,8,0"/>
                            <ComboBox x:Name="StatusFilter" Grid.Column="1" SelectedIndex="0" FontSize="13">
                                <ComboBoxItem Content="ã™ã¹ã¦" Tag="all"/>
                                <ComboBoxItem Content="æœªæ‰•ã„" Tag="unpaid"/>
                                <ComboBoxItem Content="æ”¯æ‰•æ¸ˆã¿" Tag="paid"/>
                            </ComboBox>
                            <DatePicker x:Name="FromDate" Grid.Column="3" FontSize="12"/>
                            <DatePicker x:Name="ToDate" Grid.Column="5" FontSize="12"/>
                            <Button Grid.Column="7" Content="æ¤œç´¢"
                                    Style="{StaticResource PrimaryButton}"
                                    Click="FilterButton_Click" Padding="10,8"/>
                            <Button Grid.Column="9" Content="CSVå–è¾¼"
                                    Style="{StaticResource AccentButton}"
                                    Click="ImportButton_Click" Padding="8,8"/>
                        </Grid>
                    </Border>

                    <!-- ã‚µãƒžãƒªãƒ¼ãƒãƒ¼ -->
                    <Border Grid.Row="1" Background="#EBF4FF" CornerRadius="6" Padding="16,10" Margin="0,0,0,8">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="ç·ä»¶æ•°" FontSize="11" Foreground="{StaticResource TextSecondaryBrush}"/>
                                <TextBlock x:Name="SummaryTotal" FontSize="16" FontWeight="Bold"
                                           Foreground="{StaticResource PrimaryBrush}" Text="0 ä»¶"/>
                            </StackPanel>
                            <StackPanel Grid.Column="1">
                                <TextBlock Text="æ”¯æ‰•æ¸ˆã¿" FontSize="11" Foreground="{StaticResource TextSecondaryBrush}"/>
                                <TextBlock x:Name="SummaryPaid" FontSize="16" FontWeight="Bold"
                                           Foreground="{StaticResource SuccessBrush}" Text="0 ä»¶"/>
                            </StackPanel>
                            <StackPanel Grid.Column="2">
                                <TextBlock Text="æœªæ‰•ã„" FontSize="11" Foreground="{StaticResource TextSecondaryBrush}"/>
                                <TextBlock x:Name="SummaryUnpaid" FontSize="16" FontWeight="Bold"
                                           Foreground="{StaticResource DangerBrush}" Text="0 ä»¶"/>
                            </StackPanel>
                            <StackPanel Grid.Column="3">
                                <TextBlock Text="å¾´åŽæ¸ˆã¿å®¿æ³Šç¨Žåˆè¨ˆ" FontSize="11" Foreground="{StaticResource TextSecondaryBrush}"/>
                                <TextBlock x:Name="SummaryTax" FontSize="16" FontWeight="Bold"
                                           Foreground="{StaticResource PrimaryBrush}" Text="Â¥0"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- DataGrid -->
                    <DataGrid x:Name="ReservationGrid" Grid.Row="2"
                              AutoGenerateColumns="False" IsReadOnly="True"
                              CanUserReorderColumns="False"
                              AlternatingRowBackground="#F7FAFC" RowBackground="White"
                              GridLinesVisibility="Horizontal" HeadersVisibility="Column"
                              BorderThickness="1" BorderBrush="#E2E8F0"
                              SelectionChanged="ReservationGrid_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="äºˆç´„ç•ªå·" Binding="{Binding ReservationNumber}" Width="140"/>
                            <DataGridTextColumn Header="å®¿æ³Šè€…å" Binding="{Binding GuestName}" Width="*"/>
                            <DataGridTextColumn Header="ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³" Binding="{Binding CheckinDate, StringFormat=yyyy/MM/dd}" Width="110"/>
                            <DataGridTextColumn Header="ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ" Binding="{Binding CheckoutDate, StringFormat=yyyy/MM/dd}" Width="110"/>
                            <DataGridTextColumn Header="äººæ•°" Binding="{Binding NumPersons}" Width="50"/>
                            <DataGridTextColumn Header="æ³Šæ•°" Binding="{Binding NumNights}" Width="50"/>
                            <DataGridTextColumn Header="1äºº1æ³Šæ–™é‡‘" Binding="{Binding RoomRatePerPersonPerNight, StringFormat=\{0:Â¥#\,##0\}}" Width="95"/>
                            <DataGridTextColumn Header="å®¿æ³Šç¨Žåˆè¨ˆ" Binding="{Binding AccommodationTax, StringFormat=\{0:Â¥#\,##0\}}" Width="90"/>
                            <DataGridTextColumn Header="æ±ºæ¸ˆçŠ¶æ…‹" Binding="{Binding PaymentStatusDisplay}" Width="80"/>
                            <DataGridTextColumn Header="æ±ºæ¸ˆæ—¥æ™‚" Binding="{Binding PaymentDate, StringFormat=yyyy/MM/dd HH:mm}" Width="130"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- â‘¡ æœˆæ¬¡é›†è¨ˆ -->
            <TabItem Header="æœˆæ¬¡é›†è¨ˆ">
                <Grid Margin="8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="280"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Border Grid.Column="0" Style="{StaticResource CardBorder}" Margin="0,0,8,0" VerticalAlignment="Top">
                        <StackPanel>
                            <TextBlock Text="æœˆæ¬¡é›†è¨ˆ Excel å‡ºåŠ›" FontSize="15" FontWeight="Bold"
                                       Foreground="{StaticResource PrimaryBrush}" Margin="0,0,0,16"/>

                            <TextBlock Text="å¯¾è±¡å¹´" Style="{StaticResource FieldLabel}"/>
                            <ComboBox x:Name="YearCombo" Margin="0,0,0,12" FontSize="13"/>

                            <TextBlock Text="å¯¾è±¡æœˆ" Style="{StaticResource FieldLabel}"/>
                            <ComboBox x:Name="MonthCombo" Margin="0,0,0,20" FontSize="13">
                                <ComboBoxItem Content="1æœˆ" Tag="1"/>
                                <ComboBoxItem Content="2æœˆ" Tag="2"/>
                                <ComboBoxItem Content="3æœˆ" Tag="3"/>
                                <ComboBoxItem Content="4æœˆ" Tag="4"/>
                                <ComboBoxItem Content="5æœˆ" Tag="5"/>
                                <ComboBoxItem Content="6æœˆ" Tag="6"/>
                                <ComboBoxItem Content="7æœˆ" Tag="7"/>
                                <ComboBoxItem Content="8æœˆ" Tag="8"/>
                                <ComboBoxItem Content="9æœˆ" Tag="9"/>
                                <ComboBoxItem Content="10æœˆ" Tag="10"/>
                                <ComboBoxItem Content="11æœˆ" Tag="11"/>
                                <ComboBoxItem Content="12æœˆ" Tag="12"/>
                            </ComboBox>

                            <Button Content="ðŸ“Š  ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼" Style="{StaticResource PrimaryButton}"
                                    Margin="0,0,0,8"
                                    Click="PreviewMonthlyButton_Click"/>
                            <Button Content="ðŸ’¾  Excel ã§å‡ºåŠ›" Style="{StaticResource SuccessButton}"
                                    Click="ExportExcelButton_Click"/>
                        </StackPanel>
                    </Border>

                    <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ‘ãƒãƒ« -->
                    <Border Grid.Column="1" Style="{StaticResource CardBorder}" VerticalAlignment="Top">
                        <StackPanel>
                            <TextBlock x:Name="PreviewTitle" Text="æœˆã‚’é¸æŠžã—ã¦ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼" FontSize="15" FontWeight="Bold"
                                       Foreground="{StaticResource PrimaryBrush}" Margin="0,0,0,16"/>
                            <Grid x:Name="PreviewGrid" Visibility="Collapsed">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>

                                <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,0,16">
                                    <TextBlock Text="ç·å®¿æ³Šä»¶æ•°" Style="{StaticResource FieldLabel}"/>
                                    <TextBlock x:Name="PvTotalBookings" FontSize="22" FontWeight="Bold"
                                               Foreground="{StaticResource PrimaryBrush}"/>
                                </StackPanel>
                                <StackPanel Grid.Row="0" Grid.Column="1" Margin="0,0,0,16">
                                    <TextBlock Text="ç·å®¿æ³Šäººæ•°" Style="{StaticResource FieldLabel}"/>
                                    <TextBlock x:Name="PvTotalPersons" FontSize="22" FontWeight="Bold"
                                               Foreground="{StaticResource PrimaryBrush}"/>
                                </StackPanel>
                                <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,0,16">
                                    <TextBlock Text="ç·å®¿æ³Šæ³Šæ•°" Style="{StaticResource FieldLabel}"/>
                                    <TextBlock x:Name="PvTotalNights" FontSize="22" FontWeight="Bold"
                                               Foreground="{StaticResource PrimaryBrush}"/>
                                </StackPanel>
                                <StackPanel Grid.Row="1" Grid.Column="1" Margin="0,0,0,16">
                                    <TextBlock Text="å¾´åŽæ¸ˆã¿å®¿æ³Šç¨Žåˆè¨ˆ" Style="{StaticResource FieldLabel}"/>
                                    <TextBlock x:Name="PvTotalTax" FontSize="22" FontWeight="Bold"
                                               Foreground="{StaticResource SuccessBrush}"/>
                                </StackPanel>
                                <StackPanel Grid.Row="2" Grid.Column="0" Margin="0,0,0,16">
                                    <TextBlock Text="æ±ºæ¸ˆæ¸ˆã¿ä»¶æ•°" Style="{StaticResource FieldLabel}"/>
                                    <TextBlock x:Name="PvPaidCount" FontSize="22" FontWeight="Bold"
                                               Foreground="{StaticResource SuccessBrush}"/>
                                </StackPanel>
                                <StackPanel Grid.Row="2" Grid.Column="1" Margin="0,0,0,16">
                                    <TextBlock Text="æœªæ±ºæ¸ˆä»¶æ•°" Style="{StaticResource FieldLabel}"/>
                                    <TextBlock x:Name="PvUnpaidCount" FontSize="22" FontWeight="Bold"
                                               Foreground="{StaticResource DangerBrush}"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- â‘¢ ã‚·ã‚¹ãƒ†ãƒ è¨­å®š -->
            <TabItem Header="ã‚·ã‚¹ãƒ†ãƒ è¨­å®š">
                <ScrollViewer Margin="8" VerticalScrollBarVisibility="Auto">
                    <StackPanel MaxWidth="640">

                        <Border Style="{StaticResource CardBorder}" Margin="0,0,0,12">
                            <StackPanel>
                                <TextBlock Text="æ–½è¨­æƒ…å ±" FontSize="15" FontWeight="Bold"
                                           Foreground="{StaticResource PrimaryBrush}" Margin="0,0,0,16"/>
                                <TextBlock Text="æ–½è¨­å *" Style="{StaticResource FieldLabel}"/>
                                <TextBox x:Name="PropertyNameBox" Margin="0,0,0,10"/>
                                <TextBlock Text="æ–½è¨­ä½æ‰€ *" Style="{StaticResource FieldLabel}"/>
                                <TextBox x:Name="PropertyAddressBox" Margin="0,0,0,10"/>
                                <TextBlock Text="äº‹æ¥­è€…æƒ…å ±" Style="{StaticResource FieldLabel}"/>
                                <TextBox x:Name="BusinessInfoBox" Margin="0,0,0,10" Height="60"
                                         AcceptsReturn="True" TextWrapping="Wrap"
                                         VerticalScrollBarVisibility="Auto"/>
                                <TextBlock Text="ã‚¤ãƒ³ãƒœã‚¤ã‚¹ç™»éŒ²ç•ªå·ï¼ˆTç•ªå·ï¼‰" Style="{StaticResource FieldLabel}"/>
                                <TextBox x:Name="TaxNumberBox" Margin="0,0,0,10" Style="{StaticResource PlaceholderTextBox}" Tag="T1234567890123"/>
                                <TextBlock Text="å¸‚åŒºç”ºæ‘ï¼ˆå®¿æ³Šç¨Žãƒžã‚¹ã‚¿ï¼‰" Style="{StaticResource FieldLabel}"/>
                                <ComboBox x:Name="MunicipalityCombo" Margin="0,0,0,4" FontSize="13"/>
                                <TextBlock FontSize="11" Foreground="{StaticResource TextSecondaryBrush}"
                                           Text="â€» CSVã®ã€ŒTotal Fee (Except tax)ã€ã‹ã‚‰1äºº1æ³Šæ–™é‡‘ã‚’ç®—å‡ºã—ã¦å®¿æ³Šç¨Žã‚’è‡ªå‹•è¨ˆç®—ã—ã¾ã™ã€‚"/>
                            </StackPanel>
                        </Border>

                        <Border Style="{StaticResource CardBorder}" Margin="0,0,0,12">
                            <StackPanel>
                                <TextBlock Text="Stripe æ±ºæ¸ˆè¨­å®š" FontSize="15" FontWeight="Bold"
                                           Foreground="{StaticResource PrimaryBrush}" Margin="0,0,0,16"/>
                                <TextBlock Text="Stripe Secret Key *" Style="{StaticResource FieldLabel}"/>
                                <TextBox x:Name="StripeKeyBox" Style="{StaticResource PlaceholderTextBox}"
                                         Tag="sk_live_..." Margin="0,0,0,4"/>
                                <TextBlock Text="â€» æš—å·åŒ–ã—ã¦ä¿å­˜ã•ã‚Œã¾ã™" FontSize="11"
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </Border>

                        <Border Style="{StaticResource CardBorder}" Margin="0,0,0,12">
                            <StackPanel>
                                <TextBlock Text="ãƒ¡ãƒ¼ãƒ«è¨­å®šï¼ˆSMTPï¼‰" FontSize="15" FontWeight="Bold"
                                           Foreground="{StaticResource PrimaryBrush}" Margin="0,0,0,16"/>
                                <TextBlock Text="SMTPãƒ›ã‚¹ãƒˆ *" Style="{StaticResource FieldLabel}"/>
                                <TextBox x:Name="SmtpHostBox" Style="{StaticResource PlaceholderTextBox}"
                                         Tag="smtp.gmail.com" Margin="0,0,0,10"/>
                                <TextBlock Text="SMTPãƒãƒ¼ãƒˆ" Style="{StaticResource FieldLabel}"/>
                                <TextBox x:Name="SmtpPortBox" Style="{StaticResource PlaceholderTextBox}"
                                         Tag="587" Margin="0,0,0,10"/>
                                <TextBlock Text="é€ä¿¡å…ƒãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ *" Style="{StaticResource FieldLabel}"/>
                                <TextBox x:Name="SmtpUserBox" Margin="0,0,0,10"/>
                                <TextBlock Text="SMTPãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ *" Style="{StaticResource FieldLabel}"/>
                                <PasswordBox x:Name="SmtpPassBox" Margin="0,0,0,4"/>
                                <TextBlock Text="â€» æš—å·åŒ–ã—ã¦ä¿å­˜ã•ã‚Œã¾ã™" FontSize="11"
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </Border>

                        <Border Style="{StaticResource CardBorder}" Margin="0,0,0,12">
                            <StackPanel>
                                <TextBlock Text="ç®¡ç†ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´" FontSize="15" FontWeight="Bold"
                                           Foreground="{StaticResource PrimaryBrush}" Margin="0,0,0,16"/>
                                <TextBlock Text="æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆ8æ–‡å­—ä»¥ä¸Šï¼‰" Style="{StaticResource FieldLabel}"/>
                                <PasswordBox x:Name="NewPassBox" Margin="0,0,0,10"/>
                                <TextBlock Text="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç¢ºèª" Style="{StaticResource FieldLabel}"/>
                                <PasswordBox x:Name="ConfirmPassBox"/>
                            </StackPanel>
                        </Border>

                        <Button Content="ðŸ’¾  è¨­å®šã‚’ä¿å­˜" Style="{StaticResource PrimaryButton}"
                                HorizontalAlignment="Right" Padding="24,12" Margin="0,0,0,16"
                                Click="SaveSettingsButton_Click"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- â‘£ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— -->
            <TabItem Header="ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—">
                <Border Style="{StaticResource CardBorder}" Margin="8" VerticalAlignment="Top" MaxWidth="500">
                    <StackPanel>
                        <TextBlock Text="ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—" FontSize="15" FontWeight="Bold"
                                   Foreground="{StaticResource PrimaryBrush}" Margin="0,0,0,16"/>

                        <TextBlock TextWrapping="Wrap" Foreground="{StaticResource TextSecondaryBrush}"
                                   FontSize="13" Margin="0,0,0,20"
                                   Text="å®¿æ³Šè€…ãƒ‡ãƒ¼ã‚¿ãƒ»æ±ºæ¸ˆå±¥æ­´ãƒ»è¨­å®šæƒ…å ±ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä»»æ„ã®å ´æ‰€ã«ä¿å­˜ã—ã¾ã™ã€‚å®šæœŸçš„ãªãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’æŽ¨å¥¨ã—ã¾ã™ã€‚"/>

                        <TextBlock Text="ä¿å­˜å…ˆ" Style="{StaticResource FieldLabel}"/>
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="8"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox x:Name="BackupPathBox" Grid.Column="0" IsReadOnly="True"
                                     Style="{StaticResource PlaceholderTextBox}" Tag="ä¿å­˜å…ˆãƒ•ã‚©ãƒ«ãƒ€ã‚’é¸æŠž..."/>
                            <Button Grid.Column="2" Content="å‚ç…§..." Style="{StaticResource PrimaryButton}"
                                    Padding="12,8" Click="BrowseBackupButton_Click"/>
                        </Grid>

                        <Button Content="ðŸ’¾  ä»Šã™ããƒãƒƒã‚¯ã‚¢ãƒƒãƒ—" Style="{StaticResource SuccessButton}"
                                Click="BackupButton_Click"/>

                        <Border Background="#F0FFF4" CornerRadius="6" Padding="12" Margin="0,16,0,0">
                            <TextBlock x:Name="BackupStatusText" TextWrapping="Wrap" FontSize="12"
                                       Foreground="#065F46" Text=""/>
                        </Border>
                    </StackPanel>
                </Border>
            </TabItem>

        </TabControl>
    </Grid>
</Window>
